---
title: Rust 变量与数据类型
tags: [rust]
categories: [rust]
layout: post
date: 2025-04-25 23:30:00
---

准备开始了吗？我反正准备好了，直接开冲。

## 1. Rust 数字家族
Rust 有不少数字类型，常见的是这些：

- 整数：`i8 i16 i32 i64 i128 isize`
- 无符号整数：`u8 u16 u32 u64 u128 usize`
- 浮点数：`f32 f64`

`这个时候就会有小伙伴有疑问了，为什么 Rust 数字类型这么多？`

答案很简单：不同场景要不同精度和范围。
你写嵌入式、网络协议、数据库、游戏，需求都不一样。
Rust 不替你瞎猜，类型你自己选，性能和安全都更可控。

举个最常见的：

```rust
let a: i32 = 10;
let b: u8 = 255;
let c: f64 = 3.14;
```

如果你不写类型，Rust 也会推断，但新手阶段建议多写，脑子会更清楚。

## 2. 变量：默认不可变
Rust 里变量默认是不可变的：

```rust
let x = 5;
// x = 6; // 这行会报错
```

如果你想改，就加 `mut`：

```rust
let mut x = 5;
x = 6;
println!("{x}");
```

这套规则的好处是：你一眼就知道这变量会不会被改，代码读起来省心很多。

## 3. 变量遮蔽（shadowing）
Rust 还有个很好用的东西叫遮蔽：

```rust
let x = 5;
let x = x + 1;
let x = x * 2;
println!("{x}"); // 12
```

`let` 重新声明同名变量，不是修改，而是“新建一个同名变量”。
这个技巧在类型转换时很舒服：

```rust
let spaces = "   ";
let spaces = spaces.len();
println!("{spaces}");
```

上面第一次是字符串，第二次是数字，完全合法。

## 4. 常量和静态量
常量用 `const`，必须写类型，而且值必须在编译期可确定：

```rust
const MAX_POINTS: u32 = 100_000;
```

一般命名用全大写，下划线分隔，团队里看起来很统一。

## 5. 标量类型速通
Rust 的标量类型主要 4 类：

1. 整数
2. 浮点数
3. 布尔值 `bool`
4. 字符 `char`

```rust
let ok: bool = true;
let c: char = 'R';
```

注意：`char` 是单引号，而且是一个 Unicode 标量值，不是只能存英文。

## 6. 复合类型：元组和数组
### 元组 tuple

```rust
let tup: (i32, f64, char) = (500, 6.4, 'A');
let (x, y, z) = tup;
println!("{x} {y} {z}");
```

还可以用索引访问：

```rust
println!("{}", tup.0);
```

### 数组 array

```rust
let arr = [1, 2, 3, 4, 5];
let first = arr[0];
println!("{first}");
```

数组长度固定，类型也必须一致。这个在你需要固定大小数据时特别稳。

## 7. 一个小坑：字符串转数字
这段你会经常遇到：

```rust
let n: i32 = "42".parse().expect("not a number");
println!("{n}");
```

`parse()` 需要知道你要转成啥类型，所以要么像上面这样写 `: i32`，要么在后面补泛型参数。

## 8. 结尾
如果你看到这里，变量和数据类型基本就过了一遍了。
别怕不熟，写几个小练习就会顺手。

### 课后小练习
1. 定义一个可变变量，连续加 3 次并打印。
2. 用遮蔽把字符串 `"100"` 变成数字再加 23。
3. 定义一个元组和数组，各打印一个元素。

### 下一章
下一篇我们讲 `if / loop / while / for / match`，让代码真的跑起来。

